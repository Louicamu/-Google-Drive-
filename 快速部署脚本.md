# ⚡ 快速部署命令清单

## 🚀 快速部署步骤

### 1. 安装 Vercel Blob（用于文件存储）

```powershell
npm install @vercel/blob
```

### 2. 初始化 Git（如果还没有）

```powershell
git init
git add .
git commit -m "Initial commit"
```

### 3. 推送到 GitHub

```powershell
# 创建仓库后运行
git remote add origin https://github.com/你的用户名/next-drive.git
git branch -M main
git push -u origin main
```

### 4. 部署到 Vercel

**方式 1: 使用 Vercel Dashboard（推荐）**
```
1. 访问 https://vercel.com
2. 登录并导入 GitHub 仓库
3. 配置环境变量（见下方）
4. 点击 Deploy
```

**方式 2: 使用 Vercel CLI**
```powershell
# 安装 Vercel CLI
npm install -g vercel

# 登录
vercel login

# 部署
vercel

# 部署到生产环境
vercel --prod
```

---

## 🔑 环境变量配置

### 必需的环境变量（复制粘贴到 Vercel）

```
MONGODB_URI
mongodb+srv://用户名:密码@cluster.mongodb.net/nextdrive?retryWrites=true&w=majority

NEXTAUTH_URL
https://你的项目.vercel.app

NEXTAUTH_SECRET
生成一个随机密钥（见下方命令）
```

### 生成 NEXTAUTH_SECRET

**PowerShell**:
```powershell
-join ((48..57) + (65..90) + (97..122) | Get-Random -Count 32 | ForEach-Object {[char]$_})
```

**或访问**: https://generate-secret.vercel.app/32

---

## 📦 MongoDB Atlas 快速设置

### 快速步骤

```
1. 访问 https://www.mongodb.com/cloud/atlas/register
2. 注册并创建免费集群
3. 创建数据库用户
4. 设置 Network Access: 0.0.0.0/0
5. 获取连接字符串
6. 替换 <password> 为实际密码
7. 在末尾添加 /nextdrive
```

### 连接字符串模板

```
mongodb+srv://用户名:密码@cluster-name.xxxxx.mongodb.net/nextdrive?retryWrites=true&w=majority
```

---

## 🗂️ Vercel Blob 设置

### 在 Vercel Dashboard

```
1. 项目 → Storage → Create Database
2. 选择 "Blob"
3. Store Name: nextdrive-files
4. 点击 Create
5. 连接到项目
6. 自动添加 BLOB_READ_WRITE_TOKEN
```

---

## ✅ 部署后检查

### 测试清单

```bash
# 访问应用
curl https://你的项目.vercel.app

# 测试注册
访问 /auth/signup

# 测试登录
访问 /auth/signin

# 测试上传
登录后上传文件

# 测试分享
右键文件 → 分享
```

---

## 🔄 更新部署

### 每次代码更新

```powershell
git add .
git commit -m "更新说明"
git push origin main
```

Vercel 会自动重新部署！

---

## 🆘 快速故障排除

### 构建失败

```powershell
# 本地测试构建
npm run build

# 查看错误并修复
# 然后重新推送
git add .
git commit -m "修复构建错误"
git push
```

### MongoDB 连接失败

```
1. 检查连接字符串
2. 确认 IP 白名单包含 0.0.0.0/0
3. 确认用户名密码正确
4. 确认数据库名称 /nextdrive
```

### 环境变量问题

```
1. Vercel → Settings → Environment Variables
2. 重新检查所有变量
3. 重新部署
```

---

## 📞 获取帮助

- **Vercel 文档**: https://vercel.com/docs
- **MongoDB Atlas 支持**: https://support.mongodb.com
- **Next.js 文档**: https://nextjs.org/docs

---

**预计部署时间**: 30 分钟  
**难度**: ⭐⭐⭐ 中等

